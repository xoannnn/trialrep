<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Speaking Practice – Health</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      --bg: #eef2f7;
      --card: #ffffff;
      --primary: #4f6ef7;
      --primary-dark: #3d58d6;
      --good-bg: #e6f6ea;
      --good-text: #1f7a3a;
      --bad-bg: #fde8e8;
      --bad-text: #9b1c1c;
      --chip-bg: #eef1f8;
      --text: #2d2d2d;
      --hint-color: #777;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--text);
    }

    /* App header */
    header {
      background: var(--primary);
      color: white;
      padding: 20px;
      font-size: 22px;
      font-weight: 700;
      text-align: center;
      box-shadow: 0 5px 10px rgba(0,0,0,0.15);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    /* Center container */
    .container {
      max-width: 480px;
      margin: 20px auto;
      padding: 0 15px;
    }

    .sentence {
      background: var(--card);
      border-radius: 20px;
      padding: 22px 25px;
      margin-bottom: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      transition: transform 0.2s ease;
    }

    .sentence:hover {
      transform: translateY(-3px);
    }

    p {
      font-size: 17px;
      margin-bottom: 12px;
    }

    .hint {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }

    .hint span {
      background: #eef1f8;
      color: #2d2d2d;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 14px;
      user-select: none;
      cursor: default;
      border: 1px solid #d0d5e0;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .hint span:hover {
      transform: scale(1.05);
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    }

    button {
      background: linear-gradient(135deg, #4f6ef7, #3d58d6);
      color: white;
      border: none;
      border-radius: 15px;
      padding: 12px 20px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
      transition: transform 0.2s ease, background 0.3s ease, box-shadow 0.2s ease;
    }

    button:hover:not(.recording) {
      transform: translateY(-2px);
      background: linear-gradient(135deg, #5f7ffb, #4a68d9);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    button.recording {
      background: #bbb;
      cursor: not-allowed;
      transform: none !important;
      box-shadow: none;
    }

    .output {
      margin-top: 16px;
      min-height: 30px;
    }

    .word {
      display: inline-block;
      padding: 8px 14px;
      margin: 6px 6px 0 0;
      border-radius: 999px;
      font-size: 16px;
      user-select: none;
      transition: transform 0.2s ease;
    }

    .word.correct {
      background: var(--good-bg);
      color: var(--good-text);
      box-shadow: 0 2px 5px rgba(31,122,58,0.3);
    }

    .word.wrong {
      background: var(--bad-bg);
      color: var(--bad-text);
      box-shadow: 0 2px 5px rgba(155,28,28,0.3);
    }

    .word.correct:hover,
    .word.wrong:hover {
      transform: scale(1.05);
    }

    .feedback {
      margin-top: 14px;
      font-size: 17px;
      font-weight: 600;
      color: var(--good-text);
    }
  </style>
</head>

<body>

<header>Speaking Practice App</header>

<div class="container">

  <div class="sentence">
    <p>1. You don't look well. What's wrong?</p>
    <button onclick="start(1, this)">Start speaking</button>
    <div id="out1" class="output"></div>
  </div>

  <div class="sentence">
    <p>2. I have a ______ </p>
    <div class="hint">
      <span>toothache</span>
      <span>sore throat</span>
      <span>stomach ache</span>
      <span>headache</span>
      <span>fever</span>
    </div>
    <div style="margin-top: 10px;">
      <button onclick="start(2, this)">Start speaking</button>
    </div>
    <div id="out2" class="output"></div>
  </div>

  <div class="sentence">
    <p>3. That's too bad. You should ______ </p>
    <div class="hint">
      <span>sleep well</span>
      <span>see the school nurse</span>
      <span>see the dentist</span>
      <span>see the doctor</span>
      <span>take medicine</span>
      <span>take a rest</span>
    </div>
    <div style="margin-top: 10px;">
      <button onclick="start(3, this)">Start speaking</button>
    </div>
    <div id="out3" class="output"></div>
  </div>

  <div class="sentence">
    <p>4. How do you feel today?</p>
    <button onclick="start(4, this)">Start speaking</button>
    <div id="out4" class="output"></div>
  </div>

  <div class="sentence">
    <p>5. Much better, thanks!</p>
    <button onclick="start(5, this)">Start speaking</button>
    <div id="out5" class="output"></div>
  </div>

</div>

<script>
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();
recognition.lang = 'en-US';

const sentences = {
  1: { base: ['you','dont','look','well','whats','wrong'], phrases: [] },
  2: {
    base: ['i','have','a'],
    phrases: [
      ['toothache'], ['fever'], ['headache'],
      ['sore','throat'], ['stomach','ache']
    ]
  },
  3: {
    base: ['thats','too','bad','you','should'],
    phrases: [
      ['sleep','well'],
      ['take','medicine'],
      ['take','a','rest'],
      ['see','the','doctor'],
      ['see','the','dentist'],
      ['see','the','school','nurse']
    ]
  },
  4: { base: ['how','do','you','feel','today'], phrases: [] },
  5: { base: ['much','better','thanks'], phrases: [] }
};

function start(num, btn) {
  const output = document.getElementById('out' + num);
  const config = sentences[num];

  btn.textContent = '🎤 Listening...';
  btn.classList.add('recording');
  btn.disabled = true;

  recognition.start();

  recognition.onresult = e => {
    const spoken = e.results[0][0].transcript
      .toLowerCase()
      .replace(/[^\w\s]/g,'')
      .split(' ');

    let result = '';
    let i = 0;

    config.base.forEach(word => {
      if (spoken[i] === word) {
        result += chip(word, true);
        i++;
      } else {
        result += chip(word, false);
      }
    });

    for (const phrase of config.phrases) {
      let temp = i;
      let html = '';
      let ok = true;

      for (const w of phrase) {
        if (spoken[temp] === w) {
          html += chip(w, true);
          temp++;
        } else {
          html += chip(w, false);
          ok = false;
        }
      }

      if (ok) {
        result += html;
        i = temp;
        break;
      }
    }

    for (; i < spoken.length; i++) {
      result += chip(spoken[i], false);
    }

    output.innerHTML = result;

    const hasRed = output.querySelector('.wrong') !== null;
    if (!hasRed) {
      output.innerHTML += `<div class="feedback">Good job! That’s correct.</div>`;
    }

    reset(btn);
  };

  recognition.onerror = () => {
    output.innerHTML = chip('Not recognised', false);
    reset(btn);
  };
}

function chip(word, ok) {
  return `<span class="word ${ok ? 'correct' : 'wrong'}">${word}</span>`;
}

function reset(btn) {
  btn.textContent = 'Start speaking';
  btn.classList.remove('recording');
  btn.disabled = false;
}
</script>

</body>
</html>
