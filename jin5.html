<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ask me a question!</title>
  <style>
    /* -------------------- Magazine-style Main Page -------------------- */
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: #fdf6f0;
      overflow: hidden;
      position: relative;
    }

    /* Large soft abstract circles behind content for depth */
    body::before {
      content: '';
      position: absolute;
      width: 700px;
      height: 700px;
      background: radial-gradient(circle at center, #ff6f61, transparent 70%);
      border-radius: 50%;
      top: -200px;
      left: -200px;
      z-index: -1;
      opacity: 0.6;
    }

    body::after {
      content: '';
      position: absolute;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle at center, #ffb347, transparent 70%);
      border-radius: 50%;
      bottom: -150px;
      right: -150px;
      z-index: -1;
      opacity: 0.6;
    }

    /* Page Title */
    #pageTitle {
      font-size: 48px;
      font-weight: 900;
      text-align: center;
      color: #ff6f61;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.25);
      margin-bottom: 40px;
      letter-spacing: 1px;
    }

    /* Thumbnail Card */
    #thumbnailCard {
      background: linear-gradient(145deg, #ffd699, #ffb347);
      padding: 30px;
      margin:　0 auto;
      border-radius: 25px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      text-align: center;
      transition: transform 0.3s, box-shadow 0.3s;
      z-index: 1;
    }

    #thumbnailCard:hover {
      transform: translateY(-10px) scale(1.05);
      box-shadow: 0 25px 50px rgba(0,0,0,0.35);
    }

    /* Thumbnail Image */
    #thumbnail {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      overflow: hidden;
      border: 5px solid white;
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: transform 0.3s;
    }

    #thumbnail:hover {
      transform: scale(1.1);
    }

    #thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Subtitle under thumbnail */
    #thumbnailCard p {
      margin-top: 12px;
      font-size: 14px;
      color: #333;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* -------------------- Chat Section (untouched) -------------------- */
    #chatContainer {
      width: 420px;
      height: 600px;
      background-color: #fdf6f0;
      border-radius: 20px;
      display: none;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    #chatHeader {
      background-color: #ff8c42;
      color: white;
      padding: 15px;
      font-weight: bold;
      text-align: center;
      font-size: 20px;
      border-top-left-radius: 20px;
      border-top-right-radius: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    #chatMessages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      background-color: #fff0f5;
    }

    .message {
      max-width: 70%;
      padding: 10px 14px;
      border-radius: 20px;
      margin-bottom: 10px;
      word-wrap: break-word;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      animation: fadeIn 0.3s;
      font-size: 14px;
      line-height: 1.4;
    }

    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }

    .studentMsg {
      background-color: #8fe388;
      color: #000;
      align-self: flex-end;
      border-bottom-right-radius: 5px;
    }

    .intervieweeMsg {
      background-color: #fff;
      border: 1px solid #ccc;
      align-self: flex-start;
      color: #000;
      border-bottom-left-radius: 5px;
    }

    /* Interviewee message with avatar */
.intervieweeWrapper {
  display: flex;
  align-items: flex-end;
  margin-bottom: 10px;
}

.intervieweeAvatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  margin-right: 8px;
  flex-shrink: 0;
}

.intervieweeAvatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}





    

    #chatInputContainer {
      display: flex;
      flex-direction: column;
      padding: 10px;
      background: linear-gradient(145deg, #ffffff, #ffe6cc);
      border-top: 1px solid #ccc;
    }

    #chatTitle {
      margin-bottom: 5px;
      font-weight: bold;
      text-align: center;
      color: #333;
      font-size: 16px;
    }

    #chatInputRow { display: flex; }

    #chatInput {
      flex: 1;
      padding: 10px;
      border-radius: 25px;
      border: 1px solid #ccc;
      outline: none;
      font-size: 14px;
    }

    #micButton {
      background-color: #ff6f61;
      border: none;
      color: white;
      padding: 10px 14px;
      margin-left: 10px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: background 0.2s;
    }

    #micButton:active { background-color: #ff4c3b; }

  </style>
</head>
<body>

  <div id="pageTitle">My name is John!!</div>

  <div id="thumbnailCard">
    <div id="thumbnail">
      <!-- Character display picture, auto-cropped -->
      <img src="https://xoannnn.github.io/trialrep/capture222.JPG" alt="Interviewee Thumbnail">
    </div>
    <p>Click the picture to start chatting</p>
  </div>

  <div id="chatContainer">
    <div id="chatHeader">Interview Practice</div>
    <div id="chatMessages"></div>
    <div id="chatInputContainer">
      <div id="chatTitle">Ask me a question.</div>
      <div id="chatInputRow">
        <input type="text" id="chatInput" placeholder="Type a question...">
        <button id="micButton">🎤</button>
      </div>
    </div>
  </div>

  <script>
    // ---------------------------
    // EXACT QA from your table
    // ---------------------------
    const qaData = {
      "Where did you live before?": "I lived in Spain, France, the Czech Republic, the Philippines, and Kazakhstan.",
      "What was Spain like?": "Spain is very sunny, and the people are really friendly. I like Spain a lot.",
      "When did you arrive in Japan?": "I arrived in Japan last year, in July.",
      "What did you do before?": "I was working and studying in Spain.",
      "What did you enjoy doing?": "I liked going to the beach, meeting my friends, and travelling to other countries.",
      "What was your favorite subject at school?": "My favorite subject was Physics.",
      "What did you like to do after school?": "I liked playing video games and meeting my friends.",
      "What sport did you play before?": "I played soccer, and now I play squash and pickleball.",
      "What food did you like when you were younger?": "I really liked fried chicken.",
      "Did you live in another country before?": "Yes, I lived in Spain, Italy, France, Kazakhstan, the Czech Republic, and the Philippines.",
      "Where are you from?": "I am from the Philippines.",
      "Which is your favorite city?": "My favorite city is Prague.",
      "What do you like about Japan?": "I love Japanese food.",
      "What do you not like about Japan?": "Kanji is very difficult for me.",
      "What is your favorite place in Japan?": "My favorite place in Japan is Kyoto.",
      "What do you like about your job?": "I like seeing my students every day.",
      "What is difficult in your job?": "Reading kanji is very difficult for me.",
      "What do you enjoy doing now?": "I enjoy playing sports and cooking different dishes.",
      "What are your hobbies?": "I like cooking, travelling, playing video games, meeting my friends, studying languages, running, playing squash, and watching TV shows.",
      "What is your favorite food?": "My favourite foods are fried chicken, paella, and katsu curry.",
      "What is your favorite band?": "My favourite band is Coldplay.",
      "Do you have any brothers or sisters?": "I have one sister.",
      "What do you do on the weekend?": "I meet up with my friends, watch concerts, play sports, and go biking around Matsubara.",
      "What games do you like to play?": "I like playing Valorant, God of War, Final Fantasy, etc.",
      "Who do you live with?": "I live alone.",
      "What is your favorite place to relax?": "I like relaxing in cafés.",
      "Why did you come to Japan?": "I want to learn Japanese, and living in Japan was my childhood dream.",
      "Where do you want to go?": "I want to travel to Africa and South America.",
      "What country do you want to visit?": "I want to go to Russia.",
      "What do you want to do?": "I want to improve my Japanese.",
      "Why do you want to do that?": "I want to talk to more people.",
      "What do you want to learn next?": "I want to learn how to play the violin.",
      "Where do you want to live in the future?": "I want to live in China.",
      "What job do you want to try?": "I want to be a firefighter.",
      "Do you like me?": "Yes, I like you.",
      "What is your name?": "My name is John.",
      "What do you want to do this year?": "I want to learn karate or naginata."
    };

    const inappropriateKeywords = ['sex','fuck','bitch','shit','damn','ass','idiot'];
  
    const retryMessages = [
  "Oops 😅 Can you try again?",
  "Hmm… say it one more time 🙂",
  "Sorry, I didn’t catch that. Can you repeat?",
  "Almost! Try asking again 😊"
];

    const thumbnail = document.getElementById('thumbnail');
    const chatContainer = document.getElementById('chatContainer');
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const micButton = document.getElementById('micButton');

    thumbnail.addEventListener('click', ()=>{
      chatContainer.style.display='flex';
      document.getElementById('thumbnailCard').style.display='none'; // hide thumbnail card

      // 👉 FIRST MESSAGE FROM JOHN
    addMessage("Hi, I'm John. Please ask me a question 🙂", 'interviewee');
    });

function addMessage(text, type) {
  if (type === 'interviewee') {
    const wrapper = document.createElement('div');
    wrapper.className = 'intervieweeWrapper';

    const avatar = document.createElement('div');
    avatar.className = 'intervieweeAvatar';
    avatar.innerHTML = `<img src="https://xoannnn.github.io/trialrep/capture222.JPG">`;

    const msgDiv = document.createElement('div');
    msgDiv.className = 'message intervieweeMsg';
    msgDiv.innerText = text;

    wrapper.appendChild(avatar);
    wrapper.appendChild(msgDiv);
    chatMessages.appendChild(wrapper);
  } else {
    const msgDiv = document.createElement('div');
    msgDiv.className = 'message studentMsg';
    msgDiv.innerText = text;
    chatMessages.appendChild(msgDiv);
  }

  chatMessages.scrollTop = chatMessages.scrollHeight;
}
 function typeAnswer(answer) {
  const wrapper = document.createElement('div');
  wrapper.className = 'intervieweeWrapper';

  const avatar = document.createElement('div');
  avatar.className = 'intervieweeAvatar';
  avatar.innerHTML = `<img src="https://xoannnn.github.io/trialrep/capture222.JPG">`;

  const msgDiv = document.createElement('div');
  msgDiv.className = 'message intervieweeMsg';

  wrapper.appendChild(avatar);
  wrapper.appendChild(msgDiv);
  chatMessages.appendChild(wrapper);

  chatMessages.scrollTop = chatMessages.scrollHeight;

  let i = 0;
  const interval = setInterval(() => {
    msgDiv.innerText = answer.substring(0, i + 1);
    i++;
    chatMessages.scrollTop = chatMessages.scrollHeight;
    if (i >= answer.length) clearInterval(interval);
  }, 25);
}
    function findAnswer(input){
      input = input.trim().toLowerCase().replace(/[?.!]/g,''); // remove punctuation

      for(let word of inappropriateKeywords){
        if(input.includes(word)) return "Please ask a proper interview question.";
      }

      for(const question in qaData){
        const normalizedQuestion = question.toLowerCase().replace(/[?.!]/g,'');
        if(input === normalizedQuestion) return qaData[question];
      }

      for(const question in qaData){
        const normalizedQuestion = question.toLowerCase().replace(/[?.!]/g,'');
        const qWords = normalizedQuestion.split(' ').filter(w => w.length > 2);
        const inputWords = input.split(' ').filter(w => w.length > 2);
        const allWordsMatch = qWords.every(w => inputWords.includes(w));
        if(allWordsMatch) return qaData[question];
      }

      return retryMessages[Math.floor(Math.random() * retryMessages.length)];
    }

    chatInput.addEventListener('keypress',(e)=>{
      if(e.key==='Enter' && chatInput.value.trim()!==''){
        const question = chatInput.value.trim();
        addMessage(question,'student');
        chatInput.value='';
        setTimeout(()=>{
          const answer = findAnswer(question);
          typeAnswer(answer);
        },500+Math.random()*1000);
      }
    });

    micButton.addEventListener('click', ()=>{
      if(!('webkitSpeechRecognition' in window)){
        alert('Speech Recognition not supported in this browser.');
        return;
      }
      const recognition = new webkitSpeechRecognition();
      recognition.lang='en-US';
      recognition.interimResults=false;
      recognition.maxAlternatives=1;
      recognition.start();
      recognition.onresult=(event)=>{
        const speechText = event.results[0][0].transcript;
        addMessage(speechText,'student');
        setTimeout(()=>{
          const answer = findAnswer(speechText);
          typeAnswer(answer);
        },500+Math.random()*1000);
      };
    });

  </script>
</body>

</html>







