<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ask me a question!</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  background: #fdf6f0;
}

#pageTitle {
  font-size: 48px;
  font-weight: 900;
  color: #ff6f61;
  margin-bottom: 40px;
}

#thumbnailCard {
  background: linear-gradient(145deg, #ffd699, #ffb347);
  padding: 30px;
  border-radius: 25px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
  text-align: center;
  cursor: pointer;
}

#thumbnail {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  overflow: hidden;
  border: 5px solid white;
}

#thumbnail img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

#chatContainer {
  width: 420px;
  height: 600px;
  background: #fdf6f0;
  border-radius: 20px;
  display: none;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

#chatHeader {
  background: #ff8c42;
  color: white;
  padding: 15px;
  text-align: center;
  font-size: 20px;
}

#chatMessages {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  background: #fff0f5;
}

.message {
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 20px;
  margin-bottom: 10px;
}

.studentMsg {
  background: #8fe388;
  align-self: flex-end;
}

.intervieweeWrapper {
  display: flex;
  align-items: flex-end;
  margin-bottom: 10px;
}

.intervieweeAvatar {
  width: 36px;
  height: 36px;
  margin-right: 8px;
  flex-shrink: 0; /* âœ… ADDED: prevents squishing */
}

.intervieweeAvatar img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
}

.intervieweeMsg {
  background: white;
  padding: 10px 14px;
  border-radius: 20px;
}

#micArea {
  padding: 20px;
  display: flex;
  justify-content: center;
}

#micButton {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: #ff6f61;
  border: none;
  color: white;
  font-size: 28px;
  cursor: pointer;
  position: relative;
}

#micButton.listening::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 4px solid rgba(255,0,0,0.6);
  animation: pulse 1.2s infinite;
}

@keyframes pulse {
  from { transform: scale(1); opacity: 1; }
  to { transform: scale(1.6); opacity: 0; }
}
</style>
</head>

<body>

<div id="pageTitle">My name is John!!</div>

<div id="thumbnailCard">
  <div id="thumbnail">
    <img src="https://xoannnn.github.io/trialrep/capture222.JPG">
  </div>
  <p>Click to start chatting</p>
</div>

<div id="chatContainer">
  <div id="chatHeader">Interview Practice</div>
  <div id="chatMessages"></div>
  <div id="micArea">
    <button id="micButton">ðŸŽ¤</button>
  </div>
</div>

<script>
const qaData = {
  "Where did you live before?": "I lived in Spain for many years.",
  "What was Spain like?": "Spain is very sunny, and the people are really friendly. I like Spain a lot.",
  "When did you arrive in Japan?": "I arrived in Tokyo, Japan last year, in July.",
  "What did you do before?": "I was working and studying in Spain.",
  "What did you enjoy doing?": "I liked going to the beach, meeting my friends, and travelling to other countries.",
  "What was your favorite subject at school?": "My favorite subject was Physics and lunchtime.",
  "What did you like to do after school?": "I liked playing video games, eating out, watching movies, and meeting my friends.",
  "What sport did you play before?": "I played soccer, and now I play squash and pickleball.",
  "What food did you like when you were younger?": "I really like fried chicken.",
  "Did you live in another country before?": "Yes, I lived in Spain, Italy, France, Kazakhstan, the Czech Republic, and the Philippines.",
  "Where are you from?": "I am from the Philippines and Colombia.",
  "Which is your favorite city?": "My favorite city is Prague in the Czech Republic. It is a beautiful city.",
  "What do you like about Japan?": "I love Japanese food and culture. I also like festivals and different events.",
  "What do you not like about Japan?": "Reading and remembering names in kanji is very difficult.",
  "What is your favorite place in Japan?": "My favorite place in Japan is Kyoto.",
  "What do you like about your job?": "I like seeing my students every day and talking to them.",
  "What is difficult in your job?": "Waking up early is sometimes very difficult.",
  "What do you enjoy doing now?": "I enjoy playing sports, cooking different dishes, and doing different activities each week.",
  "What are your hobbies?": "I like cooking, travelling, playing video games, meeting my friends, studying languages, running, playing squash, and watching TV shows.",
  "What is your favorite food?": "My favourite foods are fried chicken, paella, and katsu curry.",
  "What is your favorite band?": "My favourite band is Coldplay and Fallout Boy.",
  "Do you have any brothers or sisters?": "I have one older sister.",
  "What do you do on the weekend?": "I meet up with my friends, watch concerts, play sports, and go biking around Matsubara.",
  "What games do you like to play?": "I like playing Valorant, God of War, Final Fantasy, etc.",
  "Who do you live with?": "I live alone in an apartment near the school.",
  "What is your favorite place to relax?": "I like relaxing in cafÃ©s and doing nothing.",
  "Why did you come to Japan?": "I want to learn Japanese, and living in Japan was my childhood dream.",
  "Where do you want to go?": "I want to travel to Africa and South America.",
  "What country do you want to visit?": "I want to go to Russia and Iceland.",
  "What do you want to do?": "I want to improve my Japanese.",
  "Why do you want to do that?": "I want to talk to more people in Japanese.",
  "What do you want to learn next?": "I want to learn how to play the violin.",
  "Where do you want to live in the future?": "I want to live in China and Russia.",
  "What job do you want to try?": "I want to be a firefighter.",
  "Do you like me?": "Yes, I like you.",
  "What is your name?": "My name is John.",
  "What do you want to do this year?": "I want to learn karate or naginata."
};

const thumbnail = document.getElementById('thumbnailCard');
const chatContainer = document.getElementById('chatContainer');
const chatMessages = document.getElementById('chatMessages');
const micButton = document.getElementById('micButton');

function scrollToBottom() { // âœ… ADDED
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

thumbnail.onclick = () => {
  chatContainer.style.display = 'flex';
  thumbnail.style.display = 'none';
  document.getElementById('pageTitle').style.display = 'none';

  addMessage("Hi, I'm John. Please ask me a question ðŸ™‚", 'interviewee');
};

function addMessage(text, type) {
  if (type === 'interviewee') {
    const wrap = document.createElement('div');
    wrap.className = 'intervieweeWrapper';

    const av = document.createElement('div');
    av.className = 'intervieweeAvatar';
    av.innerHTML = `<img src="https://xoannnn.github.io/trialrep/capture222.JPG">`;

    const msg = document.createElement('div');
    msg.className = 'intervieweeMsg';
    msg.innerText = text;

    wrap.append(av, msg);
    chatMessages.appendChild(wrap);
  } else {
    const msg = document.createElement('div');
    msg.className = 'message studentMsg';
    msg.innerText = text;
    chatMessages.appendChild(msg);
  }

  scrollToBottom(); // âœ… ADDED
}

function typeAnswer(answer) {
  const wrap = document.createElement('div');
  wrap.className = 'intervieweeWrapper';

  const av = document.createElement('div');
  av.className = 'intervieweeAvatar';
  av.innerHTML = `<img src="https://xoannnn.github.io/trialrep/capture222.JPG">`;

  const msg = document.createElement('div');
  msg.className = 'intervieweeMsg';

  wrap.append(av, msg);
  chatMessages.appendChild(wrap);

  let i = 0;
  const interval = setInterval(() => {
    msg.innerText = answer.slice(0, ++i);
    scrollToBottom(); // âœ… ADDED
    if (i >= answer.length) clearInterval(interval);
  }, 25);
}

function findAnswer(input) {
  input = input.toLowerCase().replace(/[?.!]/g, '');
  for (const q in qaData) {
    if (input === q.toLowerCase().replace(/[?.!]/g, '')) return qaData[q];
  }
  return "Hmmâ€¦ say it one more time ðŸ™‚";
}

micButton.onclick = () => {
  if (!('webkitSpeechRecognition' in window)) return alert('Not supported');

  micButton.classList.add('listening');
  const rec = new webkitSpeechRecognition();
  rec.lang = 'en-US';
  rec.start();

  rec.onresult = e => {
    micButton.classList.remove('listening');
    const text = e.results[0][0].transcript;
    addMessage(text, 'student');
    setTimeout(() => typeAnswer(findAnswer(text)), 600);
  };

  rec.onerror = () => micButton.classList.remove('listening');
};
</script>

</body>
</html>
