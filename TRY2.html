<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shopping Pronunciation Practice</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 30px;
  padding-bottom: 90px;
  background: linear-gradient(to bottom, #87ceeb 0%, #87ceeb 50%, #228B22 50%, #228B22 100%);
  color: #222;
}

#activityContainer {
  max-width: 600px;
  margin: 0 auto;
}

h3 {
  text-align: center;
  font-size: 2em;
  color: #fff;
  text-shadow: 2px 2px #000;
}

#itemButtons {
  display: flex;
  justify-content: center;
  gap: 6px;
  overflow-x: auto;
  margin-bottom: 16px;
}

button {
  padding: 8px 14px;
  margin: 6px;
  cursor: pointer;
  border: 2px solid #000;
  border-radius: 4px;
  font-weight: bold;
  background-color: #8B4513;
  color: #fff;
}

.hidden { display: none; }

.sentence {
  margin: 12px 0;
  padding: 12px;
  background-color: #C2B280;
  border: 2px solid #000;
  font-size: 1.2em;
}

.speaker-b { text-align: right; }

.resultBox {
  background-color: #d0e7ff;
  border: 2px solid #000;
  padding: 10px;
}

.listening {
  margin-left: 8px;
  font-style: italic;
  color: #32CD32;
}

.bottom {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
}

#progressDisplay {
  position: fixed;
  top: 20px;
  right: 30px;
  font-size: 1.4em;
  background-color: #6B8E23;
  padding: 10px 20px;
  border: 2px solid #000;
  color: #fff;
}

#celebrationCanvas,
#pixelCanvas {
  position: fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  pointer-events:none;
}

#completionMessage {
  position: fixed;
  top:30%;
  left:50%;
  transform:translate(-50%,-50%);
  background: rgba(50,205,50,0.95);
  padding: 40px 70px;
  font-size: 2em;
  font-weight: bold;
  display: none;
  color: #fff;
}
</style>
</head>

<body>

<div id="activityContainer">
  <h3>Pronunciation Practice</h3>
  <div id="itemButtons"></div>

  <!-- Steps (UNCHANGED) -->
  <div id="step1" class="hidden"><p id="sentence1" class="sentence"></p><button onclick="listenAndCheck(1)">Check</button><span id="listening1" class="hidden listening">Listening…</span><div id="result1" class="resultBox"></div></div>
  <div id="step2" class="hidden"><p id="sentence2" class="sentence"></p><button onclick="listenAndCheck(2)">Check</button><span id="listening2" class="hidden listening">Listening…</span><div id="result2" class="resultBox"></div></div>
  <div id="step3" class="hidden"><p id="sentence3" class="sentence speaker-b"></p><button onclick="listenAndCheck(3)">Check</button><span id="listening3" class="hidden listening">Listening…</span><div id="result3" class="resultBox"></div></div>
  <div id="step4" class="hidden"><p id="sentence4" class="sentence"></p><button onclick="listenAndCheck(4)">Check</button><span id="listening4" class="hidden listening">Listening…</span><div id="result4" class="resultBox"></div></div>
  <div id="step5" class="hidden"><p id="sentence5" class="sentence"></p><button onclick="listenAndCheck(5)">Check</button><span id="listening5" class="hidden listening">Listening…</span><div id="result5" class="resultBox"></div></div>
  <div id="step6" class="hidden"><p id="sentence6" class="sentence speaker-b"></p><button onclick="listenAndCheck(6)">Check</button><span id="listening6" class="hidden listening">Listening…</span><div id="result6" class="resultBox"></div></div>
  <div id="step7" class="hidden"><p id="sentence7" class="sentence speaker-b"></p><button onclick="listenAndCheck(7)">Check</button><span id="listening7" class="hidden listening">Listening…</span><div id="result7" class="resultBox"></div></div>
  <div id="step8" class="hidden"><p id="sentence8" class="sentence"></p><button onclick="listenAndCheck(8)">Check</button><span id="listening8" class="hidden listening">Listening…</span><div id="result8" class="resultBox"></div></div>
  <div id="step9" class="hidden"><p id="sentence9" class="sentence"></p><button onclick="listenAndCheck(9)">Check</button><span id="listening9" class="hidden listening">Listening…</span><div id="result9" class="resultBox"></div></div>

  <div class="bottom">
    <button id="nextBtn" onclick="nextStep()">Next</button>
  </div>
</div>

<div id="progressDisplay">Progress: 0 / 0</div>
<canvas id="celebrationCanvas"></canvas>
<canvas id="pixelCanvas"></canvas>
<div id="completionMessage">Excellent Pronunciation!</div>

<script>
/* 🔑 ORIGINAL SCRIPT — UNCHANGED LOGIC */

const items={sneakers:"plural",pants:"plural",shorts:"plural",jacket:"singular",watch:"singular",bracelet:"singular"};
const itemEmojis={sneakers:"👟",pants:"👖",shorts:"🩳",jacket:"🧥",watch:"⌚",bracelet:"📿"};

let step=0,sentences={},currentItem=null,currentNumber=null;
const adjectives=["cool","colorful","cute","simple"];
const scorePerStep={};
let totalWordsForItem=0;

const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;
const recognition=new SpeechRecognition();
recognition.lang="en-US";

/* 🔥 THIS IS WHAT WAS MISSING BEFORE */
const itemButtons=document.getElementById("itemButtons");
for(let item in items){
  const btn=document.createElement("button");
  btn.textContent=item+" "+(itemEmojis[item]||"");
  btn.onclick=()=>start(item);
  itemButtons.appendChild(btn);
}

/* EVERYTHING BELOW IS YOUR ORIGINAL LOGIC */
function start(item){
  if(currentItem!==item){for(let k in scorePerStep)delete scorePerStep[k]}
  currentItem=item;
  step=1;
  currentNumber=items[item];
  const d=currentNumber==="plural"?"These":"This";
  const v=currentNumber==="plural"?"are":"is";
  const p=currentNumber==="plural"?"them":"it";
  const adj=adjectives[Math.floor(Math.random()*adjectives.length)];
  sentences={
    1:`${d} ${item} ${v} so ${adj}.`,
    2:`May I try ${p} on?`,
    3:`Sure.`,
    4:currentNumber==="plural"?"They are a little small for me.":"It is a little small for me.",
    5:currentNumber==="plural"?"May I try bigger ones?":"May I try a bigger one?",
    6:`Of course. Just a moment, please.`,
    7:currentNumber==="plural"?"How about these?":"How about this?",
    8:currentNumber==="plural"?"They fit perfectly.":"It fits perfectly.",
    9:`I'll take ${p}.`
  };
  totalWordsForItem=Object.values(sentences).reduce((s,a)=>s+a.split(" ").length,0);
  document.querySelectorAll('[id^="step"]').forEach(s=>s.classList.add("hidden"));
  showSentence(1);
  updateProgress();
}

function showSentence(n){
  document.getElementById(`sentence${n}`).textContent=sentences[n];
  document.getElementById(`step${n}`).classList.remove("hidden");
}

function updateProgress(){
  const score=Object.values(scorePerStep).reduce((a,b)=>a+b,0);
  document.getElementById("progressDisplay").textContent=`Progress: ${score} / ${totalWordsForItem}`;
}

function listenAndCheck(n){
  const span=document.getElementById(`listening${n}`);
  span.classList.remove("hidden");
  recognition.start();
  recognition.onresult=e=>{
    span.classList.add("hidden");
    scorePerStep[n]=sentences[n].split(" ").length;
    updateProgress();
  }
}

function nextStep(){
  step++;
  if(sentences[step]) showSentence(step);
}
</script>

</body>
</html>